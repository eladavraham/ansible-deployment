# This playbook deploys services implemented in gaia

# detect coreos cluster
- include: detect_cluster.yaml

- name: Deploy GAIA services
  hosts: coreos_cluster_manager
  gather_facts: False
  vars:
    gaia_fleet_location: "{{ gaia_fleet_dir | default('../gaia-fleet') }}"
  roles:
    # gaia services. Must match gaia services in deploy_all.yaml
    - { role: deploy_fleet_service, service_file: 'grafana.service' }
    - { role: deploy_fleet_service, service_file: 'events-indexer.service' }
    - { role: deploy_fleet_service, service_file: 'security-token-service.service' }
    - { role: deploy_fleet_service, service_file: 'metrics-gateway-service.service' }
    - { role: deploy_fleet_service, service_file: 'result-upload-service.service' }
    - { role: deploy_fleet_service, service_file: 'circleci-tests-processor.service' }
    - { role: deploy_fleet_service, service_file: 'jenkins-tests-processor.service' }
    - { role: deploy_fleet_service, service_file: 'haproxy.service' }
